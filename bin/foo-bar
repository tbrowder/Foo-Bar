#!/usr/bin/env raku

use Foo::Bar;

if not @*ARGS {
    print qq:to/HERE/;
    Usage: {$*PROGRAM.basename} <mode> [...options]

    Shows or downloads files in the /resources directory.
    Downloads are to the current directory unless you
      specify another location.

    Modes:
      s[how]       - list the files in /resources
      d[ownload]   - to the current directory
      d[ownload]=X - to directory X

    Options:
      f[orce]      - allow overwriting an existing file
    HERE
    exit;
}

my $dir   = $*CWD;
my $force = 0;
for @*ARGS {
    when /^ :i s/ {
        show-resources-files;
    }
    when /^ :i d \w* '=' (\S+) $/ {
        my $d = ~$0;
        unless $d.IO.d {
            die "FATAL: '$d' is not a usable directory";
        }
        $dir = $d;
        download-resources-files $dir, :$force;
    }
    when /^ :i d/ {
        download-resources-files $dir;
    }
    default {
        say "FATAL: Unknown arg '$_'";
        exit;
    }
}
